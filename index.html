<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <title>六十甲子抽籤</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
        }

        .marquee-container {
            position: relative;
            width: 300px;
            height: 140px;
            overflow: hidden;
            margin: 10px auto;
            border: 2px solid #000;
            background-color: #f8f8f8;
        }

        .marquee-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
        }

        .marquee-wrapper span {
            padding: 10px;
            font-size: 18px;
            text-align: center;
            line-height: 40px;
            height: 40px;
            font-family: 'Arial', sans-serif;
        }

        .highlight {
            background-color: pink;
        }

        .pointer {
            position: absolute;
            top: 8px;
            left: -30px;
            width: 30px;
            height: 40px;
            background-color: red;
            color: white;
            font-size: 20px;
            text-align: center;
            line-height: 40px;
            border-radius: 5px;
            transform: rotate(90deg);
            z-index: 1;
        }



        #spin-button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div class="container text-center">
        <div class="row align-items-start">
            <div class="col">
                <h4>日辰</h4>
                <div class="marquee-container">
                    <div class="pointer">↑</div>
                    <div class="marquee-wrapper" id="marquee">
                        <!-- 六十甲子的項目會顯示在這裡 -->
                    </div>
                </div>
            </div>

            <div class="col">
                <h4>月將</h4>
                <div class="marquee-container">
                    <div class="pointer">↑</div>
                    <div class="marquee-wrapper" id="marquee2">
                        <!-- 六十甲子的項目會顯示在這裡 -->
                    </div>
                </div>
            </div>
            <div class="col">
                <h4>占時</h4>
                <div class="marquee-container">
                    <div class="pointer">↑</div>
                    <div class="marquee-wrapper" id="marquee3">
                        <!-- 六十甲子的項目會顯示在這裡 -->
                    </div>
                </div>
            </div>
        </div>
    </div>


    <button id="spin-button">抽籤</button>

    <script>
        const sixtyJiazi = [
            "甲子", "乙丑", "丙寅", "丁卯", "戊辰", "己巳", "庚午", "辛未", "壬申", "癸酉",
            "甲戌", "乙亥", "丙子", "丁丑", "戊寅", "己卯", "庚辰", "辛巳", "壬午", "癸未",
            "甲申", "乙酉", "丙戌", "丁亥", "戊子", "己丑", "庚寅", "辛卯", "壬辰", "癸巳",
            "甲午", "乙未", "丙申", "丁酉", "戊戌", "己亥", "庚子", "辛丑", "壬寅", "癸卯",
            "甲辰", "乙巳", "丙午", "丁未", "戊申", "己酉", "庚戌", "辛亥", "壬子", "癸丑",
            "甲寅", "乙卯", "丙辰", "丁巳", "戊午", "己未", "庚申", "辛酉", "壬戌", "癸亥"
        ];

        const twelve = ["子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"];

        const itemHeight = 40;

        function createList(wrapper, list, repeat = 50) {
            for (let i = 0; i < repeat; i++) {
                list.forEach(text => {
                    const span = document.createElement("span");
                    span.textContent = text;
                    wrapper.appendChild(span);
                });
            }
        }

        const m1 = document.getElementById("marquee");
        const m2 = document.getElementById("marquee2");
        const m3 = document.getElementById("marquee3");

        createList(m1, sixtyJiazi, 40);
        createList(m2, twelve, 200);
        createList(m3, twelve, 200);

        let spinning = false;

        function spin(wrapper, listLength) {

            const randomIndex = Math.floor(Math.random() * listLength);

            const middleStart = Math.floor(wrapper.children.length / 2);

            const finalIndex = middleStart + randomIndex;

            const finalPosition = -(finalIndex * itemHeight);

            // 亂轉一段
            wrapper.style.transition = "transform 1.5s ease-in";
            wrapper.style.transform = `translateY(${finalPosition - 600}px)`;

            // 停下
            setTimeout(() => {
                wrapper.style.transition = "transform 0.5s ease-out";
                wrapper.style.transform = `translateY(${finalPosition}px)`;
            }, 1500);
        }

        document.getElementById("spin-button").addEventListener("click", () => {
            if (spinning) return;
            spinning = true;

            spin(m1, 60);
            spin(m2, 12);
            spin(m3, 12);

            setTimeout(() => {
                spinning = false;
            }, 2500);
        });

    </script>


</body>

</html>
